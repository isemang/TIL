# 인덱스(Index)의 종류와 특징

## 1) 인덱스와 범위스캔

- 원래는 테이블을 처음부터 끝까지 모든 레코드를 읽어서 결과를 얻음.
- 인덱스: 키, 컬럼 순으로 정렬되어 있기 때문에. 특정 위치에서 스캔을 시작할 수 있음. 그리고 일치하지 않는 값을 만나는 순간 멈출 수도 있음 → **범위 스캔**

## 2) 인덱스의 기본 구조 : B-Tree 인덱스, BITMAP 인덱스
- 인덱스의 종류에는 **B-TREE 인덱스**와 **BITMAP 인덱스**가 있다.

## 3) 인덱스 종류: B-Tree 인덱스 (가장 일반적으로 사용됨)
![image](https://user-images.githubusercontent.com/52986346/149496874-718060cd-c11e-415b-9e97-53515f1d6a96.png)

### ✔ Root Bock, Branch Block, Leaf Block

1. Root Block, Branch Block: 하위 노드 블록을 찾아가기 위한 DBA(Data Block Address)정보를 가짐
2. Leaf Block: 인덱스 키 컬럼과 함께, 해당 테이블 레코드를 찾아가기 위한 주소정보(rowid)를 가짐. 항상 키-컬럼 순으로 정렬되어 있기 때문에, **범위 스캔**이 가능함. 키 값이 같을 때는 rowid순으로 정렬됨

### ✔ B-Tree 인덱스에서 필요한 값을 찾는 방법

- 실제 테이블의 주소는 Leaf Block들에 전부 들어있고, 해당 데이터들에 대한 데이터들이 Branch Block과 Root Block에 들어있음
- 특정 데이터를 찾아야 할 경우 : Root Block에서 → Branch Block 정보를 찾고 → 그 정보를 토대로 Leaf Block 정보를 찾아가서 → 해당 데이터의 ROWID를 찾아 → 데이터가 들어있는 블록을 메모리로 복사해온다.
- B-Tree 인덱스의 종류 : UNIQUE INDEX, Non UNIQUE INDEX, Function Based INDEX, DESCENDING INDEX, 결합 인덱스(Composite Index)

#### 결합 인덱스(Composite Index)
- 인덱스를 생성할 때 두 개 이상의 컬럼을 합쳐서 인덱스를 만드는 것
- 인덱스의 결합 순서(사용 순서)도 매우 중요함
- 예시 : 성별이 남자이고 이름이 홍길동인 데이터를 찾아보자
    - 1번 : 성별 + 이름
    
    ```
    1. 성별이 "남자"인 사람을 먼저 찾는다
    60명 -> "남자" -> 25명 (25명으로 추렸다)
    
    2. 그 후, 25명 중 이름이 "홍길동"인 사람을 찾는다
    25명 -> "홍길동" -> 2명
    
    결론) 성별을 먼저 이용했더니 총 25회의 검사가 필요하다
    ```
    
    - 2번 : 이름 + 성별
    
    ```
    1. 이름이 "홍길동"인 사람을 먼저 찾는다
    60명 -> "홍길동" -> 2명
    
    2. 그 후, 2명 중 성별이 "남자"인 사람을 찾는다
    2명 -> "남자" -> 2명
    
    결론) 이름을 먼저 이용했더니 총 2회의 검사가 필요하다
    ```
## 4) 인덱스 종류: BITMAP 인덱스
- B-Tree 형식의 인덱스는 주로 데이터 값의 종류가 많고 동일한 데이터가 적을 경우 사용함
- BITMAP 인덱스는 데이터의 종류가 적고, 동일한 데이터가 많을 경우 사용
- 데이터가 어디에 있다는 지도정보를 BIT로 표시하고, 데이터가 있으면 '1', 없으면 '0'으로 표시됨
### ✔ 맵은 인덱스 컬럼의 개수만큼 만들어진다
#### ex) 회원정보에 '지역'이라는 컬럼이 있으면 아래와 같이 맵이 생성됨
```
서울: 1 0 1 0 0

대전: 0 1 0 0 1

대구: 0 0 0 1 1
```
- 만약, "울산"이라는 데이터가 추가된다면?<br>
  -> BITMAP 인덱스를 모두 수정해야하고, "울산"이라는 MAP을 추가해야 함<br>
  -> **B-TREE INDEX는 관련 블록만 변경하면 되지만, BITMAP 인덱스는 모든 맵을 다 수정해야 한다!**
- 주로 데이터 변경이 안되는 테이블과, 값의 종류가 작은 컬럼에 생성함

___
[참고한 곳]<br>
https://bae9086.tistory.com/82?category=835443  <br>
https://lee-mandu.tistory.com/483
